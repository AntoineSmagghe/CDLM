{% extends 'base.html.twig' %}
{% block header %}
  <link rel="stylesheet" href="css/home_public_index.css">
{% endblock %}
{% block style %}{% endblock %}
{% block title %}Bienvenue au Chant de la Machine, ce site rassemble l'association organisatrice d'évènements, le label de musique et bien d'autre choses.{% endblock %}

{% block body %}
<div class="welcome_view">
    <h1>Well I there {% if app.user != null %} {{ app.user.surname }} {% endif %}!</h1>
</div>
<h2>What's new on CDLM?</h2>
<section id="welcome_cards">
{% for article in articles %}
{% set text = article.text|raw %}
  <div class="card_welcome">
    <div class="in_card_welcome">
      <div class="col_wel_img">
          {% if article.img == '' %}
          <img src="img/CDLM_logo.svg" class="card-img-top" alt="Photo de l'article : {{article.title}}">
          {% else %}
          <img src="{{ asset('upload/pictures/' ~ article.img) }}" class="card-img-top" alt="Photo de l'article : {{article.title}}">
          {% endif %}
      </div>
      <div class="col_wel_txt">
        <div class="card-body">
          <h5 class="card-title">{{ article.title }}</h5>
          <p class="card-text">{{ text[:150] ~ '...' }}</p>
          <a href="{{ path("article", {"format" : article.format, "id" : article.id }) }}" class="btn btn-primary">More...</a>
          {% if is_granted('ROLE_ADMIN') %}
            <a href="{{ path("editPost", { "id" : article.id }) }}" class="btn btn-success">Modifier</a>
            <form method="POST" action="{{ path("delPost", { "id" : article.id }) }}">
              <input type="hidden" name="_method" value="DELETE">
              <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ article.id) }}">
              <button class="btn btn-danger">Supprimer</button>
            </form>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endfor %}
</section>
{% endblock %}
