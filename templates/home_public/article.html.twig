{% extends 'base.html.twig' %}

{% block title %}{{article.text[:200]|striptags }}{% endblock %}
{% block style %}
<link rel="stylesheet" href="/css/article.css">
<link rel="stylesheet" href="/css/home_public_index.css">
{% endblock %}
{% block body %}
    <section id="article_body">
        {% if article.imgs != '' %}
        <img class="article_image_cover" src="{{ asset('/upload/pictures/' ~ article.imgs|first ) }}" alt="">
        {% else %}
        <img src="img/CDLM_logo.svg" alt="Photo de l'article : {{article.title}}">
        {% endif %}
        <h1 class="article_cover_title">{{ article.title }}</h1>
        {% if is_granted('ROLE_ADMIN') %}
            <a href="{{ path("editPost", { "id" : article.id }) }}" class="btn_modify">Modifier</a>
            <form method="POST" action="{{ path("delPost", { "id" : article.id }) }}">
                <input type="hidden" name="_method" value="DELETE">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ article.id) }}">
                <button class="btn_del">Supprimer</button>
            </form>
        {% endif %}
        <p class="">Organis√© le : {{ article.dateEvent|date("d/m/Y") }}</p>
        <div class="txt_and_music">
            <aside>
                <h2 class="subtitle">Description</h2>
                <p class="">{{ article.text|raw }}</p>
            </aside>
            <aside>
                <h2 class="subtitle">Musique</h2>
                <p class="">{{ article.apiData|raw }}</p>
            </aside>
        </div>
        <div class="">
            <div class="">
                <iframe width="100%" height="20" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/{{ article.apiData }}&color=%230e0d26&inverse=true&auto_play=true&show_user=true"></iframe>
            </div>
            <div class="">
                <p class="">Created at : {{ article.createdAt|date("H\\hm\\ms\\s \\l\\e d/m/Y", "Europe/Paris") }} by {{ article.user.surname }}</p>
            </div>
            {% if article.modifiedBy != '' %}
            <div class="">
                <p class="">Modified at : {{ article.updatedAt|date("H\\hm\\ms\\s \\l\\e d/m/Y", "Europe/Paris") }} by {{ article.modifiedBy.surname }}</p>
            </div>
            {% endif %}
        </div>
        <h2 class="subtitle">Galerie</h2>
        <div class="hes-gallery">
        {% if article.imgs is defined %}
            {% for image in article.imgs %}
                    <img src="{{ asset('/upload/pictures/' ~ image.name) }}" alt="Photo {{image.id}} de l'article : {{ article.title }}">
            {% endfor %}
        {% endif %}
        </div>
    </section>
{% endblock %}
{% block javascripts %}
<script src="https://unpkg.com/hes-gallery/dist/hes-gallery.min.js"></script>
{% endblock %}